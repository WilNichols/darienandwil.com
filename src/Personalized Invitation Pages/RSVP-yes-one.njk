---
layout: 'paginated.njk'
permalink: 'invitations/{{ invitations[pagination.pageNumber].code }}/rsvp-yes-one/index.html'
isFormSubmissionPage: true
---
{%- from 'header.njk' import smallHeader with context -%}
{%- from 'navigation.njk' import navigation with context -%}
{%- from 'rsvp-form.njk' import rsvpForm with context -%}

{# This is a lot of redundancy but I can't figure out how to cascade it :/  #}
  {% set invitation = invitations[pagination.pageNumber] %}
  {% set isAttending = 'unknown' %}
  {% set partySizeInt = invitation.party.length %}
  {% set partySizeWord = strings.numbers[partySizeInt - 1] %}
  {% for notAttending in rsvpForms %}
    {% if notAttending.data.code == invitation.code %}
      {% set isAttending = 'no' %}
    {% endif %}
  {% endfor %}
  {% set invitationData = {
    name: invitation.name,
    code: invitation.code,
    attending: isAttending
  } %}
  {% if partySizeInt > 1 %}{% set suffix = 's' %}{% endif %}
  {% set subtitle = rsvpSteps.formSubtitle | replace('%num%', partySizeWord) | replace('%plu%', suffix) %}
{# end copypasta #}

<div class="page page--program">
  {{ navigation(invitationData) }}
  <div class="form__action">
    <a href="#confirm" id="button--continue" class="button--primary">{{ strings.continue }}</a>
    <button 
      type="submit"
      onClick="saveRSVPLocal()"
      id="button--submit" 
      class="button--primary">
      {{ strings.submit }}
    </button>
  </div>
  <main class="form-content">
    {{ smallHeader(rsvpSteps.formTitle, subtitle)}}
    <div class="form-items">
      {% for attendee in invitation.party %}
         {{ rsvpForm(loop, attendee) }}
      {% endfor %}
    </div>
  </main>
</div>
